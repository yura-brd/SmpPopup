!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("SmpPopup",[],t):"object"==typeof exports?exports.SmpPopup=t():e.SmpPopup=t()}("undefined"==typeof self?this:self,function(){return function(){"use strict";var e={273:function(e,t,s){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var s=0;s<t.length;s++){var o=t[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function n(e,t,s){return(t=r(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function r(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}Object.defineProperty(t,"__esModule",{value:!0}),t.SmpPopupInit=void 0;var a=s(606),l=function(){return e=function e(t){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n(this,"id",void 0),n(this,"$this",void 0),n(this,"options",{}),n(this,"$wrapper",void 0),n(this,"$bodyHTML",void 0),n(this,"classPopup",void 0),n(this,"closePopupButton",void 0),n(this,"wrapperAddClass",void 0),n(this,"bodyHtmlAddClass",void 0),n(this,"closeAddClass",void 0),n(this,"callbackCloseAlways",null),n(this,"localCallbackCloseBefore",void 0),n(this,"returnBoolClose",!1),this.id=t.id,this.$this=t.$this,this.wrapperAddClass=t.wrapperAddClass,this.bodyHtmlAddClass=t.bodyHtmlAddClass,this.closeAddClass=t.closeAddClass,this.options=t.options||{},this.classPopup=t.classPopup,this.localCallbackCloseBefore=t.localCallbackCloseBefore,this.initHTML(),setTimeout(function(){s.$wrapper&&(s.$wrapper.classList.add("open"),s.$wrapper.tabIndex=0,document.body.classList.add("open_popup"))},10)},t=[{key:"hide",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.$wrapper){this.$wrapper.classList.remove("open"),document.body.classList.remove("open_popup"),this.localCallbackCloseBefore(this.id,this.returnBoolClose);var s=".".concat(this.classPopup,"__content"),o=this.$this.querySelector(s);(t||o&&o.dataset.removeBeforeClose&&"false"!==o.dataset.removeBeforeClose)&&setTimeout(function(){var t;null===(t=e.$wrapper)||void 0===t||null===(t=t.parentNode)||void 0===t||t.removeChild(e.$wrapper)},300)}}},{key:"initHTML",value:function(){var e=this,t=document.getElementById(this.id+a.ID_SUFFIX);if(t)this.$wrapper=t,this.$wrapper.dataset.firstInit="false",document.body.appendChild(this.$wrapper),setTimeout(function(){var t;null===(t=e.$wrapper)||void 0===t||t.classList.add("open"),document.body.classList.add("open_popup")},10);else{this.$wrapper=document.createElement("div"),this.$wrapper.id=this.id+a.ID_SUFFIX,this.$wrapper.className=this.classPopup,this.wrapperAddClass&&this.$wrapper.classList.add(this.wrapperAddClass),this.$wrapper.dataset.firstInit="true",this.$wrapper.setAttribute("aria-modal","true"),this.$wrapper.setAttribute("role","true");var s=document.createElement("div");s.className="".concat(this.classPopup,"__overlay"),s.dataset.close="true";var o=document.createElement("div");o.className="".concat(this.classPopup,"__wrapper"),this.bodyHtmlAddClass&&o.classList.add(this.bodyHtmlAddClass),o.dataset.close="true",this.closePopupButton=document.createElement("button"),this.closePopupButton.type="button";var i="".concat(this.classPopup,"__close");this.closeAddClass&&(i+=" ".concat(this.closeAddClass)),this.closePopupButton.className=i,this.closePopupButton.setAttribute("aria-label","Close window"),this.closePopupButton.innerText="Close window",this.closePopupButton.dataset.close="true",this.closePopupButton.dataset.tabIndex="0",this.closePopupButton.dataset.focusClose="true",this.$bodyHTML=document.createElement("div"),this.$bodyHTML.className="".concat(this.classPopup,"__body"),o.append(this.$bodyHTML);var n=document.createElement("div");n.tabIndex=0,n.dataset.lastIndexActive="1",o.append(n),this.$bodyHTML.append(this.closePopupButton);var r=!1;this.$wrapper.addEventListener("mousedown",function(e){r=!1;var t=e.target;t.dataset.close&&0===e.button&&(t===o?t.clientWidth>e.clientX&&(r=!0):r=!0)}),this.$wrapper.addEventListener("mouseup",function(t){var s=t.target;s.dataset.close&&0===t.button&&r&&(s===o?s.clientWidth>t.clientX&&(t.preventDefault(),e.hide(!1)):(e.returnBoolClose=!!s.dataset.returnTrue,t.preventDefault(),e.hide(!1))),r=!1}),this.$wrapper.addEventListener("keyup",function(t){var s,o=t.target;"Enter"===t.key&&o.dataset.focusClose&&(e.returnBoolClose=!!o.dataset.returnTrue,t.preventDefault(),e.hide(!1)),"Tab"===t.key&&o.dataset.lastIndexActive&&(null===(s=e.closePopupButton)||void 0===s||s.focus())}),this.$wrapper.addEventListener("keydown",function(t){var s,o=t.target;"Tab"===t.key&&o.dataset.lastIndexActive&&(null===(s=e.closePopupButton)||void 0===s||s.focus())}),this.$wrapper.append(s),this.$wrapper.append(o),document.body.append(this.$wrapper),this.$bodyHTML.append(this.$this),this.options.wrapperAddClass&&this.$wrapper.classList.add(this.options.wrapperAddClass),this.options.bodyAddClass&&this.$bodyHTML.classList.add(this.options.bodyAddClass)}if(!0===this.options.restart){var l=this.$wrapper.querySelector(".".concat(this.classPopup,"__content"));l&&(l.dataset.removeBeforeClose="true")}}}],t&&i(e.prototype,t),s&&i(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,s}();t.SmpPopupInit=l},606:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ID_SUFFIX=void 0,t.ID_SUFFIX="_popup_init"},710:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isIncludeDomElement=t.getIdFromHash=t.getHref=void 0;t.getHref=function(e){return e?e.dataset&&e.dataset.href?e.dataset.href:e.getAttribute("href"):null};t.getIdFromHash=function(e){return"#"===e[0]?e.slice(1):e};t.isIncludeDomElement=function(e,t){return t.toLowerCase().split(",").includes(e.nodeName.toLowerCase())}},927:function(e,t,s){s.r(t)}},t={};function s(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,s),n.exports}s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return function(){var e=o;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function i(e,t){for(var s=0;s<t.length;s++){var o=t[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function n(e,t,s){return(t=r(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function r(e){var s=function(e,s){if("object"!=t(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,s||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(e)}(e,"string");return"symbol"==t(s)?s:s+""}var a=s(273),l=s(710),u=s(606);s(927);var d=function(){return e=function e(t){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n(this,"itemsPopup",[]),n(this,"isAutoFocusInput",void 0),n(this,"classPopup",void 0),n(this,"wrapperAddClass",void 0),n(this,"bodyHtmlAddClass",void 0),n(this,"closeAddClass",void 0),n(this,"callbackOpenAlways",null),n(this,"callbackOpenOnce",null),n(this,"callbackCloseAlways",null),n(this,"DOM_ELEMENT_POPUP",void 0),n(this,"selectorLinks",void 0),n(this,"keyEscHide",function(e){if("Escape"===e.code){if((0,l.isIncludeDomElement)(e.target,"input,label,textarea,video,audio,select"))return;var t=s.itemsPopup[s.itemsPopup.length-1];t?t.hide():document.removeEventListener("keyup",s.keyEscHide)}}),t||(t={}),this.classPopup=t.classPopup?t.classPopup:"b_popup",this.wrapperAddClass=t.wrapperAddClass?t.wrapperAddClass:void 0,this.bodyHtmlAddClass=t.bodyHtmlAddClass?t.bodyHtmlAddClass:void 0,this.closeAddClass=t.closeAddClass?t.closeAddClass:void 0,this.callbackOpenOnce=t.callbackOpenOnce?t.callbackOpenOnce:null,this.callbackOpenAlways=t.callbackOpenAlways?t.callbackOpenAlways:null,this.callbackCloseAlways=t.callbackCloseAlways?t.callbackCloseAlways:null,this.isAutoFocusInput=!t.isAutoFocusInput||t.isAutoFocusInput,t.selectorLinks?"string"==typeof t.selectorLinks?this.selectorLinks=document.querySelectorAll(t.selectorLinks):this.selectorLinks=t.selectorLinks:this.selectorLinks=document.querySelectorAll("[data-open-popup]"),this.init()},t=[{key:"init",value:function(){var e=this;this.selectorLinks&&(this.selectorLinks instanceof HTMLElement?this.selectorLinks.addEventListener("click",function(t){return e.handlerClick(t,e.selectorLinks)}):this.selectorLinks.length&&this.selectorLinks.forEach(function(t){t.addEventListener("click",function(s){return e.handlerClick(s,t)})}))}},{key:"handlerClick",value:function(e,t){e.preventDefault();var s=(0,l.getHref)(t);if(s){var o=(0,l.getIdFromHash)(s),i={};t.dataset.addClassBody&&(i.bodyAddClass=t.dataset.addClassBody),this.show(o,i)}}},{key:"show",value:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=document.getElementById(e);if(o){var i=new a.SmpPopupInit({$this:o,id:e,classPopup:this.classPopup,bodyHtmlAddClass:this.bodyHtmlAddClass,wrapperAddClass:this.wrapperAddClass,closeAddClass:this.closeAddClass,options:s,localCallbackCloseBefore:this.hideBefore.bind(this)});this.DOM_ELEMENT_POPUP=o,this.itemsPopup.push(i),setTimeout(function(){document.addEventListener("keyup",t.keyEscHide)},10),this.inputAutoFocus();var n=document.getElementById(e+u.ID_SUFFIX);return n&&"true"===n.dataset.firstInit&&this.callbackOpenOnce&&this.callbackOpenOnce(o),this.callbackOpenAlways&&this.callbackOpenAlways(o),o}return null}},{key:"hideBefore",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=this.itemsPopup.filter(function(t){return t.id===e})[0],o=this.itemsPopup.filter(function(t){return t.id!==e});return this.callbackCloseAlways&&this.callbackCloseAlways(s.$this,t),this.itemsPopup=o,0===o.length&&document.removeEventListener("keyup",this.keyEscHide),null}},{key:"inputAutoFocus",value:function(){if(this.DOM_ELEMENT_POPUP&&this.isAutoFocusInput){var e=this.DOM_ELEMENT_POPUP.querySelector("[data-autofocus]");e||(e=this.DOM_ELEMENT_POPUP.querySelector('input:not([type="hidden"])')),e&&setTimeout(function(){var t;null===(t=e)||void 0===t||t.focus()},200)}}},{key:"hideForId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.itemsPopup.forEach(function(s){s.id===e&&s.hide(t)}),null}},{key:"hideAll",value:function(){return this.itemsPopup.forEach(function(e){return e.hide()}),null}},{key:"removeFormDOM",value:function(e){this.itemsPopup.forEach(function(t){t.id===e&&t.hide(!0)});var t=document.getElementById(e+u.ID_SUFFIX);t&&t.remove()}},{key:"getOpenPopups",value:function(){return this.itemsPopup}}],t&&i(e.prototype,t),s&&i(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,s}();e.default=d}(),o=o.default}()});